<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>文件路径Tooltip测试</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
            font-size: 14px;
            padding: 20px;
        }
        
        .file-item {
            background-color: white;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 12px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .file-item:hover {
            background-color: #f8f9fa;
            border-color: #667eea;
        }
        
        .file-info {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: nowrap;
            width: 100%;
        }
        
        .file-info > * {
            flex-shrink: 0;
        }
        
        .file-path-info {
            color: #6c757d;
            font-size: 10px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 200px;
            display: inline-block;
            vertical-align: bottom;
            cursor: help;
            position: relative;
        }
        
        .file-path-tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 11px;
            white-space: nowrap;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s ease;
            max-width: 400px;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .file-path-tooltip.show {
            opacity: 1;
        }
        
        .test-section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body>
    <div class="container">
        <h2 class="mb-4">文件路径Tooltip功能测试</h2>
        
        <div class="test-section">
            <h5>短路径测试</h5>
            <div class="file-item">
                <div class="file-info">
                    <i class="bi bi-file-text text-primary"></i>
                    <span>app.log</span>
                    <span class="badge bg-light text-dark">1.2 MB</span>
                    <span class="file-path-info" 
                          data-full-path="/var/log/app.log" 
                          onmouseenter="showPathTooltip(this, event)" 
                          onmouseleave="hidePathTooltip(this)">
                        /var/log/app.log
                    </span>
                </div>
            </div>
        </div>
        
        <div class="test-section">
            <h5>中等长度路径测试</h5>
            <div class="file-item">
                <div class="file-info">
                    <i class="bi bi-file-text text-primary"></i>
                    <span>nginx.log</span>
                    <span class="badge bg-light text-dark">2.5 MB</span>
                    <span class="file-path-info" 
                          data-full-path="/var/log/nginx/access.log" 
                          onmouseenter="showPathTooltip(this, event)" 
                          onmouseleave="hidePathTooltip(this)">
                        /var/log/nginx/access.log
                    </span>
                </div>
            </div>
        </div>
        
        <div class="test-section">
            <h5>长路径测试</h5>
            <div class="file-item">
                <div class="file-info">
                    <i class="bi bi-file-text text-primary"></i>
                    <span>application.log</span>
                    <span class="badge bg-light text-dark">5.8 MB</span>
                    <span class="file-path-info" 
                          data-full-path="/opt/company/project/production/logs/application/2024/01/15/application.log" 
                          onmouseenter="showPathTooltip(this, event)" 
                          onmouseleave="hidePathTooltip(this)">
                        /opt/company/project/production/logs/application/2024/01/15/application.log
                    </span>
                </div>
            </div>
        </div>
        
        <div class="test-section">
            <h5>超长路径测试</h5>
            <div class="file-item">
                <div class="file-info">
                    <i class="bi bi-file-text text-primary"></i>
                    <span>system.log</span>
                    <span class="badge bg-light text-dark">12.3 MB</span>
                    <span class="file-path-info" 
                          data-full-path="/home/user/workspace/very/long/project/path/that/exceeds/normal/display/width/and/needs/tooltip/to/show/full/path/information/system.log" 
                          onmouseenter="showPathTooltip(this, event)" 
                          onmouseleave="hidePathTooltip(this)">
                        /home/user/workspace/very/long/project/path/that/exceeds/normal/display/width/and/needs/tooltip/to/show/full/path/information/system.log
                    </span>
                </div>
            </div>
        </div>
        
        <div class="test-section">
            <h5>说明</h5>
            <ul>
                <li>文件路径超过200px宽度时会显示省略号(...)</li>
                <li>鼠标悬浮在路径上时会显示完整的tooltip</li>
                <li>tooltip会自动调整位置，避免超出屏幕边界</li>
                <li>鼠标离开时tooltip会自动消失</li>
            </ul>
        </div>
    </div>

    <script>
        // 显示文件路径tooltip
        function showPathTooltip(element, event) {
            const fullPath = element.getAttribute('data-full-path');
            if (!fullPath) return;

            // 移除已存在的tooltip
            const existingTooltip = document.querySelector('.file-path-tooltip');
            if (existingTooltip) {
                existingTooltip.remove();
            }

            // 创建新的tooltip
            const tooltip = document.createElement('div');
            tooltip.className = 'file-path-tooltip';
            tooltip.textContent = fullPath;
            document.body.appendChild(tooltip);

            // 计算tooltip位置
            const rect = element.getBoundingClientRect();
            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
            const scrollLeft = window.pageXOffset || document.documentElement.scrollLeft;

            // 优先显示在元素下方，如果空间不够则显示在上方
            let top = rect.bottom + scrollTop + 5;
            if (top + tooltip.offsetHeight > window.innerHeight + scrollTop) {
                top = rect.top + scrollTop - tooltip.offsetHeight - 5;
            }

            // 水平居中显示
            let left = rect.left + scrollLeft + (rect.width / 2) - (tooltip.offsetWidth / 2);
            if (left < scrollLeft) {
                left = scrollLeft + 5;
            } else if (left + tooltip.offsetWidth > window.innerWidth + scrollLeft) {
                left = window.innerWidth + scrollLeft - tooltip.offsetWidth - 5;
            }

            tooltip.style.top = top + 'px';
            tooltip.style.left = left + 'px';

            // 显示tooltip
            setTimeout(() => {
                tooltip.classList.add('show');
            }, 100);
        }

        // 隐藏文件路径tooltip
        function hidePathTooltip(element) {
            const tooltip = document.querySelector('.file-path-tooltip');
            if (tooltip) {
                tooltip.classList.remove('show');
                setTimeout(() => {
                    if (tooltip.parentNode) {
                        tooltip.remove();
                    }
                }, 200);
            }
        }
    </script>
</body>
</html>
