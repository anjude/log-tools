# 日志管理工具新功能说明

## 新增功能概览

本次更新为日志管理工具添加了以下三个重要功能：

### 1. 日志文件区域紧凑显示

**改进内容：**
- 每个日志文件现在只占用一行，大大节省了垂直空间
- 文件信息更加紧凑，包括文件名、修改时间和文件大小
- 添加了文件图标，提升视觉效果

**显示效果：**
```
📁 根目录
📄 app.log    2024-01-01 10:00:00    [2.5 KB]
📄 error.log  2024-01-01 09:30:00    [1.8 KB]

📁 子目录
📄 backup.log 2024-01-01 08:00:00    [5.2 KB]
```

### 2. 日志文件列表搜索功能

**功能特性：**
- 在文件列表顶部添加了搜索输入框
- 支持按文件名搜索
- 支持按完整文件路径搜索
- 实时搜索，输入时即时过滤结果
- 智能显示/隐藏目录标题

**使用方法：**
1. 在搜索框中输入关键词
2. 系统会实时过滤显示匹配的文件
3. 支持部分匹配，不区分大小写
4. 清空搜索框可恢复显示所有文件

**搜索示例：**
- 输入 `app` 可找到所有包含 "app" 的文件
- 输入 `error` 可找到所有包含 "error" 的文件
- 输入路径片段可找到特定目录下的文件

### 3. 完整文件路径显示

**功能特性：**
- 鼠标悬停在文件上可看到完整文件路径
- 文件信息中包含目录信息
- 按目录分组显示，便于文件管理

**显示信息：**
- **文件名**：显示日志文件的基本名称
- **修改时间**：显示文件的最后修改时间
- **文件大小**：显示文件大小（自动格式化）
- **完整路径**：鼠标悬停显示完整文件路径
- **所属目录**：按目录分组显示文件

## 技术实现

### 后端改进

1. **LogFile结构体扩展**
   ```go
   type LogFile struct {
       Path         string `json:"path"`         // 相对路径
       Name         string `json:"name"`         // 文件名
       FullPath     string `json:"full_path"`   // 完整文件路径
       Directory    string `json:"directory"`   // 所属目录
       Size         int64  `json:"size"`
       ModTime      string `json:"mod_time"`
   }
   ```

2. **排序逻辑优化**
   - 首先按目录名称排序
   - 同一目录内按文件名排序
   - 提供更直观的文件组织结构

### 前端改进

1. **文件列表布局**
   - 紧凑的单行显示
   - 目录标题分组
   - 文件图标和状态指示

2. **搜索功能实现**
   - 实时搜索过滤
   - 智能显示/隐藏元素
   - 搜索结果提示

3. **样式优化**
   - 响应式设计
   - 悬停效果
   - 视觉层次清晰

## 使用方法

### 启动服务
```bash
# 编译并运行
go build -o log-tools.exe .
./log-tools.exe

# 或直接运行
go run .
```

### 访问界面
1. 打开浏览器访问 `http://localhost:6003`
2. 使用配置的用户名和密码登录
3. 在左侧文件列表中使用搜索功能
4. 点击文件查看日志内容

### 文件搜索
1. 在文件列表顶部的搜索框中输入关键词
2. 系统会实时显示匹配的文件
3. 支持文件名和路径搜索
4. 清空搜索框恢复全部显示

## 配置说明

确保 `config.yaml` 文件包含正确的日志目录配置：

```yaml
logs:
  directories:
    - "E:\workspace\bean-milk\log-tools\logs"
    - "C:\logs\application"
  pattern: ".*\\.log$"
  default_lines: 200
  max_search_results: 1000
```

## 兼容性说明

- 新功能完全向后兼容
- 现有的API接口保持不变
- 配置文件格式保持兼容
- 支持单目录和多目录配置

## 性能优化

- 文件列表按需加载
- 搜索功能使用前端过滤，响应迅速
- 文件信息缓存，减少重复计算
- 优化的排序算法，提升显示效率

## 后续计划

- 支持文件类型图标
- 添加文件收藏功能
- 支持文件标签和分类
- 增强搜索功能（支持正则表达式）
- 添加文件预览功能
